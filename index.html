<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Toxic Transition</title>
    <style>
      :root {
        --bg: #090909;
        --text: #f2eee9;
        --text-muted: rgba(242, 238, 233, 0.9);
        --shadow: rgba(0, 0, 0, 0.72);
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        background: var(--bg);
        color: var(--text);
        font-family: "Avenir Next", "Helvetica Neue", Arial, sans-serif;
      }

      .intro {
        position: relative;
        height: 280vh;
      }

      .sticky-stage {
        position: sticky;
        top: 0;
        height: 100vh;
        overflow: hidden;
        isolation: isolate;
        background: var(--bg);
      }

      .media-layer {
        position: absolute;
        inset: 0;
      }

      .media-layer video,
      .media-layer img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .video-layer {
        opacity: 1;
      }

      .photo-layer {
        opacity: 0;
      }

      .media-layer::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0.25) 10%,
          rgba(0, 0, 0, 0.58) 65%,
          rgba(0, 0, 0, 0.72) 100%
        );
      }

      .text-layer {
        position: absolute;
        inset: 0;
        z-index: 2;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 8vh 7vw;
      }

      .title {
        margin: 0;
        max-width: 12ch;
        font-size: clamp(2.25rem, 8vw, 6.4rem);
        letter-spacing: 0.03em;
        line-height: 0.95;
        text-transform: uppercase;
        text-shadow: 0 12px 36px var(--shadow);
      }

      .video-dek {
        margin: 0;
        max-width: min(920px, 90vw);
        font-size: clamp(1.05rem, 2.15vw, 1.9rem);
        line-height: 1.35;
        color: var(--text-muted);
        text-shadow: 0 8px 26px var(--shadow);
        opacity: 0;
      }

      .photo-copy {
        margin-top: 2.4rem;
        max-width: min(1000px, 92vw);
        color: var(--text-muted);
        text-shadow: 0 8px 26px var(--shadow);
        opacity: 0;
      }

      .photo-copy p {
        margin: 0;
        font-size: clamp(1.02rem, 1.8vw, 1.55rem);
        line-height: 1.48;
      }

      .photo-copy p + p {
        margin-top: 1.6rem;
      }

      .after-intro {
        min-height: 35vh;
        padding: 12vh 8vw;
        background: #080808;
      }

      .after-intro p {
        margin: 0;
        max-width: 70ch;
        color: rgba(242, 238, 233, 0.72);
      }

      @media (prefers-reduced-motion: reduce) {
        .video-layer,
        .photo-layer,
        .title,
        .video-dek,
        .photo-copy {
          transition: none !important;
        }
      }
    </style>
  </head>
  <body>
    <section class="intro" id="intro">
      <div class="sticky-stage">
        <div class="media-layer video-layer" id="videoLayer">
          <video
            src="assets/drc_cobalt_front_vid.mov"
            autoplay
            muted
            loop
            playsinline
          ></video>
        </div>

        <div class="media-layer photo-layer" id="photoLayer">
          <img src="assets/Taillights.png" alt="Taillights in the DRC" />
        </div>

        <div class="text-layer">
          <h1 class="title" id="titleText">Toxic Transition</h1>
          <p class="video-dek" id="videoDek">
            A new investigation by the Environmental Investigation Agency US
            (EIA) and PremiCongo into cobalt mining in the Democratic Republic
            of the Congo (DRC) exposes the toxic underbelly of the world’s
            energy transition.
          </p>
          <div class="photo-copy" id="photoCopy">
            <p>
              The investigation: The last few years have seen dramatic growth
              in the production and sale of EVs, as well as in the lithium-ion
              batteries needed to power these vehicles. As a consequence,
              demand is surging for critical minerals like cobalt, which these
              batteries rely on.
            </p>
            <p>
              The investigation ties the rapid growth of the world’s largest
              cobalt producer and the booming production of electric vehicles
              (EVs) by some of the world’s largest car manufacturers - such as
              Volkswagen, Mercedes-Benz, BMW, and Stellantis - to what appears
              to be air pollution spanning multiple years, impacting dozens of
              families and workers.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="after-intro">
      <p>Continue with your next scrollytell section here.</p>
    </section>

    <script>
      const intro = document.getElementById("intro");
      const videoLayer = document.getElementById("videoLayer");
      const photoLayer = document.getElementById("photoLayer");
      const titleText = document.getElementById("titleText");
      const videoDek = document.getElementById("videoDek");
      const photoCopy = document.getElementById("photoCopy");

      function clamp(value, min, max) {
        return Math.min(max, Math.max(min, value));
      }

      function updateIntroProgress() {
        const rect = intro.getBoundingClientRect();
        const total = Math.max(1, rect.height - window.innerHeight);
        const scrolled = clamp(-rect.top, 0, total);
        const progress = scrolled / total;

        const mediaMix = clamp((progress - 0.48) / 0.28, 0, 1);
        const titleLift = clamp(progress / 0.22, 0, 1);
        const titleFade = clamp((progress - 0.58) / 0.2, 0, 1);
        const videoDekIn = clamp((progress - 0.07) / 0.12, 0, 1);
        const videoDekOut = clamp((progress - 0.52) / 0.16, 0, 1);
        const photoCopyFade = clamp((progress - 0.66) / 0.18, 0, 1);

        videoLayer.style.opacity = String(1 - mediaMix);
        photoLayer.style.opacity = String(mediaMix);

        titleText.style.opacity = String(1 - titleFade);
        titleText.style.transform = `translateY(${titleLift * -68}px)`;

        const videoDekOpacity = videoDekIn * (1 - videoDekOut);
        videoDek.style.opacity = String(videoDekOpacity);
        videoDek.style.transform = `translateY(${(1 - videoDekIn) * 20}px)`;

        photoCopy.style.opacity = String(photoCopyFade);
        photoCopy.style.transform = `translateY(${(1 - photoCopyFade) * 22}px)`;
      }

      updateIntroProgress();
      window.addEventListener("scroll", updateIntroProgress, { passive: true });
      window.addEventListener("resize", updateIntroProgress);
    </script>
  </body>
</html>
